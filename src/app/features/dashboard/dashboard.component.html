<app-header></app-header>

<mat-card class="page-heading">
  <mat-form-field appearance="outline" class="">
    <mat-label>Choose status</mat-label>
    <mat-select [formControl]="statusFC">
      <mat-option
        *ngFor="let status of statusesDocuments()"
        [value]="status.value"
        >{{ status.viewValue }}</mat-option
      >
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Creator</mat-label>
    <input
      type="text"
      matInput
      [matAutocomplete]="auto"
      [formControl]="creatorIdFC"
    />
    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayUserName">
      <mat-option *ngFor="let user of filteredUsers()" [value]="user">
        {{ user.fullName }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Creator Email</mat-label>
    <input type="text" matInput [formControl]="creatorEmailFC" />
  </mat-form-field>
</mat-card>

<div class="page-content">
  <mat-card appearance="outlined" class="">
    <mat-table class="" [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="name">
        <mat-header-cell
          class=""
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          >name</mat-header-cell
        >
        <mat-cell mat-cell *matCellDef="let row">
          <span>{{ row.name }}</span>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="creator">
        <mat-header-cell
          class=""
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          >creator</mat-header-cell
        >
        <mat-cell mat-cell *matCellDef="let row">
          <span>{{ row.creator?.fullName }}</span>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="status">
        <mat-header-cell
          class=""
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          >status</mat-header-cell
        >
        <mat-cell mat-cell *matCellDef="let row">
          <span>{{ row.status }}</span>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="updatedAt">
        <mat-header-cell
          class=""
          mat-header-cell
          *matHeaderCellDef
          mat-sort-header
          >updatedAt</mat-header-cell
        >
        <mat-cell mat-cell *matCellDef="let row">
          <span>{{ row.updatedAt | date : "dd.MM.yyyy HH:mm" }}</span>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="settings">
        <mat-header-cell
          class="setting-column"
          mat-header-cell
          *matHeaderCellDef
          ><mat-icon>settings</mat-icon></mat-header-cell
        >
        <mat-cell class="setting-column" mat-cell *matCellDef="let row">
          <button
            *ngIf="!isReviewerUser"
            mat-icon-button
            (click)="navigateToDocument(row.id)"
          >
            <mat-icon>edit</mat-icon>
          </button>
          <button
            *ngIf="isReviewerUser"
            mat-icon-button
            (click)="navigateToDocument(row.id)"
          >
            <mat-icon>visibility</mat-icon>
          </button>
        </mat-cell></ng-container
      >

      <mat-header-row
        *matHeaderRowDef="displayedColumns; sticky: true"
      ></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns"> </mat-row>
    </mat-table>

    <mat-paginator
      [length]="resultsLength"
      [pageIndex]="paginatorPage"
      [pageSize]="paginatorPageSize"
      [pageSizeOptions]="[1, 5, 10, 15]"
      (page)="handlePageEvent($event)"
    >
    </mat-paginator>
  </mat-card>
</div>
